$(document).ready(function () {

  $('.mois').hide();

  //--------------INFORMATIONS---------------
  $('.biv_indice_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.biv_indice_value').val(value);
  });
  $('.biv_direction_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.biv_direction_value').val(value);
  });
  $('.biv_attente_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.biv_attente_value').val(value);
  });
  //--------------INFORMATIONS---------------
  //-----------------Q2----------------------
  $('.Q21_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q21_value').val(value);
  });
  $('.Q22_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q22_value').val(value);
  });
  $('.Q23_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q23_value').val(value);
  });
  $('.Q24_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q24_value').val(value);
  });
  //-----------------Q2----------------------
  //-----------------Q3----------------------
  $('.Q31_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q31_value').val(value);
  });
  $('.Q32_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q32_value').val(value);
  });
  $('.Q33_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q33_value').val(value);
  });
  $('.Q34_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q34_value').val(value);
  });
  //-----------------Q3----------------------
  //-----------------Q4----------------------
  $('.Q41_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q41_value').val(value);
  });
  $('.Q42_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q42_value').val(value);
  });
  $('.Q43_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q43_value').val(value);
  });
  //-----------------Q4----------------------
  //-----------------Q5----------------------
  $('.Q51_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q51_value').val(value);
  });
  $('.Q52_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q52_value').val(value);
  });
  $('.Q53_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q53_value').val(value);
  });
  $('.Q54_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q54_value').val(value);
  });
  $('.Q55_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q55_value').val(value);
  });
  $('.Q56_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q56_value').val(value);
  });
  $('.Q57_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q57_value').val(value);
  });
  $('.Q58_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q58_value').val(value);
  });
  //-----------------Q5----------------------
  //-----------------Q6----------------------
  $('.Q61_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q61_value').val(value);
  });
  $('.Q62_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q62_value').val(value);
  });
  $('.Q63_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q63_value').val(value);
  });
  $('.Q64_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q64_value').val(value);
  });
  $('.Q65_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q65_value').val(value);
  });
  $('.Q66_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q66_value').val(value);
  });
  $('.Q67_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q67_value').val(value);
  });
  $('.Q68_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q68_value').val(value);
  });
  $('.Q69_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q69_value').val(value);
  });
  $('.Q610_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q610_value').val(value);
  });
  $('.Q611_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q611_value').val(value);
  });
  $('.Q612_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q612_value').val(value);
  });
  $('.Q613_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q613_value').val(value);
  });
  $('.Q614_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q614_value').val(value);
  });
  //-----------------Q6----------------------
  //-----------------Q7----------------------
  $('.Q71_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.Q71_value').val(value);
  });
  //-----------------Q7----------------------
  //-----------------MR2----------------------
  $('.MR21_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR21_value').val(value);
  });
  $('.MR21Detail_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR21Detail_value').val(value);
  });
  $('.MR21Bis_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR21Bis_value').val(value);
  });
  $('.MR21DetailBis_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR21DetailBis_value').val(value);
  });
  //-----------------MR2----------------------
  //-----------------MR3----------------------
  $('.MR31_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR31_value').val(value);
  });
  $('.MR32_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR32_value').val(value);
  });
  //-----------------MR3----------------------
  //-----------------MR4----------------------
  $('.MR41_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR41_value').val(value);
  });
  $('.MR42_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR42_value').val(value);
  });
  //-----------------MR4----------------------
  //-----------------MR5----------------------
  $('.MR51_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR51_value').val(value);
  });
  $('.MR52_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR52_value').val(value);
  });
  $('.MR53_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR53_value').val(value);
  });
  $('.MR54_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR54_value').val(value);
  });
  $('.MR55_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR55_value').val(value);
  });
  //-----------------MR5----------------------
  //-----------------MR6----------------------
  $('.MR61_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR61_value').val(value);
  });
  $('.MR62_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR62_value').val(value);
  });
  $('.MR63_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR63_value').val(value);
  });
  $('.MR64_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR64_value').val(value);
  });
  //-----------------MR6----------------------
  //-----------------MR7----------------------
  $('.MR71_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR71_value').val(value);
  });
  $('.MR72_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR72_value').val(value);
  });
  $('.MR73_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR73_value').val(value);
  });
  $('.MR74_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR74_value').val(value);
  });
  $('.MR75_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR75_value').val(value);
  });
  $('.MR76_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR76_value').val(value);
  });
  $('.MR77_select').change(function () {
    var value = $(this).val();
    if (value != '0') $('.MR77_value').val(value);
  });
  //-----------------MR7----------------------
  //----------------ticket------------------
  $('#questionnaire_ticket').change(function () {
    if ($(this).is(':checked')) $(this).val(1);
    else $(this).val(0);
  });

  $('.json-export').click(function () {
    jsonExport();
  });

  $('.back').click(function () {
    window.location.href = Routing.generate('bus_questionnaire_all', { mois: $('.mois').text() });
  });

});

function jsonExport() {
  var base_url = Routing.getBaseUrl().replace(/\w+\.php$/gi, '');
  $('.loader').append('<img src="' + base_url + '/images/gears.svg" class="svg-loader" />');

  $.ajax({

    url: Routing.generate('bus_json_generate_one', true),
    type: 'POST',
    async: false,
    data: { id: $('.id').text(), date: $('.date').text() },
    dataType: 'json',
    success: function (response, statut) {
      if (response == true) {
        setJsonStatut($('.id').text());
        alert('JSON généré!');
        $('.loader').empty('.svg-loader');
      }
    },
    error: function (resultat, statut, erreur) {
      alert('Problème, JSON non généré!');
      $('.loader').empty('.svg-loader');
    },
    complete: function (resultat, statut) {
      $('.loader').empty('.svg-loader');
    }
  });
}

function setJsonStatut(id) {
  $.ajax({

    url: Routing.generate('bus_json_set_statut_one', true),
    type: 'POST',
    async: false,
    data: { id: $('.id').text(), statut: 1 },
    dataType: 'json',
    success: function (response, statut) {
      $('.json-statut').text('Exporté!');
      $('.json-statut').attr('class', 'text-success');
    },
    error: function (resultat, statut, erreur) {
      console.log('ERREUR: ' + erreur);
    },
    complete: function (resultat, statut) {

    }
  });
}